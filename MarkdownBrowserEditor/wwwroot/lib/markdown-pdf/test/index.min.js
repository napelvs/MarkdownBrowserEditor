/**
 * Minified by jsDelivr using Terser v5.3.5.
 * Original file: /npm/markdown-pdf@10.0.0/test/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var fs=require("fs"),path=require("path"),test=require("tape"),markdownpdf=require("../"),tmp=require("tmp"),through=require("through2"),pdfText=require("pdf-text");tmp.setGracefulCleanup(),test("generate a nonempty PDF from ipsum.md",(function(t){t.plan(4),tmp.file({postfix:".pdf"},(function(n,r,o){t.ifError(n),fs.closeSync(o),markdownpdf().from(path.join(__dirname,"/fixtures/ipsum.md")).to(r,(function(n){t.ifError(n),fs.readFile(r,{encoding:"utf8"},(function(n,r){t.ifError(n),t.ok(r.length>0),t.end()}))}))}))})),test("generate PDF with CSS from ipsum.md and style.css",(function(t){t.plan(6),tmp.file({postfix:".pdf"},(function(n,r,o){t.ifError(n),fs.closeSync(o),markdownpdf({cssPath:path.join(__dirname,"/fixtures/style.css")}).from(path.join(__dirname,"/fixtures/ipsum.md")).to(r,(function(n){t.ifError(n),fs.readFile(r,{encoding:"utf8"},(function(n,o){t.ifError(n),t.ok(o.length>0),pdfText(r,(function(n,r){t.ifError(n),t.ok(/forty-two/.test(r.join("")),"contains h1::after injected content"),t.end()}))}))}))}))})),test("output should have a header and footer",(function(t){t.plan(7),tmp.file({postfix:".pdf"},(function(n,r,o){t.ifError(n),fs.closeSync(o),markdownpdf({runningsPath:path.join(__dirname,"/fixtures/runnings.js")}).from(path.join(__dirname,"/fixtures/ipsum.md")).to(r,(function(n){t.ifError(n),fs.readFile(r,{encoding:"utf8"},(function(n,o){t.ifError(n),t.ok(o.length>0),pdfText(r,(function(n,r){t.ifError(n),t.ok(/Some\s?Header/.test(r.join(""))),t.ok(/Some\s?Footer/.test(r.join(""))),t.end()}))}))}))}))})),test("should call preProcessMd hook",(function(t){t.plan(3);var n=0;markdownpdf({preProcessMd:function(){return through((function(t,r,o){n++,this.push(t),o()}))}}).from(path.join(__dirname,"/fixtures/ipsum.md")).to.string((function(r,o){t.ifError(r),t.ok(o.length>0),t.ok(n>0,"Write count expected to be > 0"),t.end()}))})),test("should call preProcessHtml hook",(function(t){t.plan(3);var n=0;markdownpdf({preProcessHtml:function(){return through((function(t,r,o){n++,this.push(t),o()}))}}).from(path.join(__dirname,"/fixtures/ipsum.md")).to.string((function(r,o){t.ifError(r),t.ok(o.length>0),t.ok(n>0,"Write count expected to be > 0"),t.end()}))})),test("should concatenate source files",(function(t){t.plan(4);var n=[path.join(__dirname,"/fixtures/first.md"),path.join(__dirname,"/fixtures/second.md")];tmp.file({postfix:".pdf"},(function(r,o,e){t.ifError(r),fs.closeSync(e),markdownpdf().concat.from(n).to(o,(function(n){t.ifError(n),fs.readFile(o,{encoding:"utf8"},(function(n,r){t.ifError(n),t.ok(r.length>0),t.end()}))}))}))})),test("should write to multiple paths when converting multiple files",(function(t){t.plan(6);var n=[path.join(__dirname,"/fixtures/first.md"),path.join(__dirname,"/fixtures/second.md")];tmp.file({postfix:".pdf"},(function(r,o,e){t.ifError(r),fs.closeSync(e),tmp.file({postfix:".pdf"},(function(r,e,i){t.ifError(r),fs.closeSync(i),markdownpdf().from.paths(n).to.paths([o,e],(function(n){t.ifError(n);var r=fs.readFileSync(o,{encoding:"utf8"}),i=fs.readFileSync(e,{encoding:"utf8"});t.ok(r.length>0),t.ok(i.length>0),t.ok(r.length!==i.length),t.end()}))}))}))})),test("should accept remarkable preset",(function(t){t.plan(2);var n="";markdownpdf({remarkable:{preset:"full"},preProcessHtml:function(){return through((function(t,r,o){n+=t,o()}),(function(r){var o=n.indexOf("<sup>st</sup>")>-1;t.ok(o,'html <sup> tag not found for preset "full"'),r()}))}}).from.string("1^st^ of January").to.string((function(n,r){t.ifError(n),t.end()}))})),test("should initialize remarkable plugins",(function(t){t.plan(2);var n=!1;markdownpdf({remarkable:{plugins:[void 0,"test",function(t,r){n=!0}]}}).from(path.join(__dirname,"/fixtures/ipsum.md")).to.string((function(r,o){t.ifError(r),t.assert(n,"check plugin init"),t.end()}))}));
//# sourceMappingURL=/sm/b375c2839cb5289177bcca9c7b8fd5c9b54f776e2fa22c427c83c0a972887f93.map